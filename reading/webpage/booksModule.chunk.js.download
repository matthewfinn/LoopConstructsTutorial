(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{138:function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return l})),i.d(e,"c",(function(){return h}));var n=i(4),o=i(0);const s=$(document),a=$(window);var r,l;!function(t){t[t.center=0]="center",t[t.left=1]="left",t[t.right=2]="right"}(r||(r={})),function(t){t[t.center=0]="center",t[t.above=1]="above",t[t.below=2]="below"}(l||(l={}));const c={dontCleanPrevious:!1,dontShowOnClick:!1,horizontalPosition:r.center,verticalPosition:l.below,dontAutomaticallyPosition:!1,additionalClasses:"",contentHtml:"",isFixed:!1,showOnMouseOver:!1};class h{constructor(t){this.$tooltip=$(d),this.$parentContainer=$(t||document.body),this.$parentContainer.append(this.$tooltip),this.$contentContainer=this.$tooltip.find(".tooltip-container"),this.handleDocumentClick=this.handleDocumentClick.bind(this),this.handleResizeStart=this.handleResizeStart.bind(this),n.a.onDescendantEventWithCooldown(this.$tooltip,o.b.isCordova()?"touchstart":"click",".command-row, .item-row",t=>this.handleCommandRowClick(t.currentTarget)),this.$contentContainer.on("mousewheel DOMMouseScroll",t=>{n.a.handleContainerScroll(t),t.stopPropagation()})}initialize(t,e,i,n,o){this.initializeConfig(o),this.config.dontCleanPrevious||this.clean(),this.config.contentHtml&&this.$contentContainer.html(this.config.contentHtml),this.beforeOpenCallback=e,this.commandExecuteCallback=i,this.afterCloseCallback=n,this.config.additionalClasses&&this.$tooltip.addClass(this.config.additionalClasses),this.updateReferentElement(t)}updateReferentElement(t){this.$referentElements&&this.$referentElements.off("click mouseenter"),this.$referentElements=t,this.config.dontShowOnClick||n.a.onEventWithCooldown(this.$referentElements,"click",t=>{this.isOpen?this.close():this.handleReferentElementInteraction(t.currentTarget)}),this.config.showOnMouseOver&&n.a.onEventWithCooldown(this.$referentElements,"mouseenter",t=>this.handleReferentElementInteraction(t.currentTarget))}clean(){this.close(),this.$referentElements&&this.$referentElements.off(),this.config&&this.$tooltip.removeClass(this.config.additionalClasses),this.$referentElements=null,this.currentReferentElement=null,this.beforeOpenCallback=null}open(t){t&&(this.currentReferentElement=t,this.beforeOpenCallback&&this.beforeOpenCallback($(t),this.$contentContainer)||(s.on("click",this.handleDocumentClick),a.on("resizestart",this.handleResizeStart),this.reposition(t),this.isOpen=!0,this.$tooltip.addClass("advanced-tooltip-opened")))}openAtPosition(t,e,i,n){this.beforeOpenCallback&&this.beforeOpenCallback($(null),this.$contentContainer)||(this.currentReferentElement=t,s.on("click",this.handleDocumentClick),a.on("resizestart",this.handleResizeStart),this.$tooltip.css("top",e.top+"px"),this.$tooltip.css("left",e.left+"px"),this.positionTip(i.horizontalPosition,i.verticalPosition,n),this.$tooltip.css("display","block"),this.$tooltip.addClass("advanced-tooltip-opened"),this.isOpen=!0)}reposition(t){if(t||(t=this.currentReferentElement),!t)return;let e=$(t).find(".fa");e&&0!==e.length||(e=$(t));const i=this.getOffsetFromParentContainer(e),n=this.$tooltip.width(),o=this.$tooltip.height(),c=a.width(),h=s.height();let d=this.config.horizontalPosition,u=this.config.verticalPosition;this.config.dontAutomaticallyPosition||(i.left+n/2<.95*c&&i.left-n/2>.05*c?d=r.center:i.left+n>c?d=r.left:i.left-n<0&&(d=r.right),d===r.center?i.top+3*this.getElementHeight(e)+o>h&&(u=l.above):d!==r.left&&d!==r.right||(u=l.center)),this.centerMenuHorizontaly(e,d),this.centerMenuVertically(e,u),this.positionTip(d,u),this.$tooltip.css("display","block")}getMenuWidth(){return this.$tooltip.width()}getMenuHeight(){return this.$tooltip.height()}initializeConfig(t){t?(this.config={},this.config.dontCleanPrevious="dontCleanPrevious"in t?t.dontCleanPrevious:c.dontCleanPrevious,this.config.horizontalPosition="horizontalPosition"in t?t.horizontalPosition:c.horizontalPosition,this.config.verticalPosition="verticalPosition"in t?t.verticalPosition:c.verticalPosition,this.config.dontAutomaticallyPosition="dontAutomaticallyPosition"in t?t.dontAutomaticallyPosition:c.dontAutomaticallyPosition,this.config.isFixed="isFixed"in t?t.isFixed:c.isFixed,this.config.contentHtml="contentHtml"in t?t.contentHtml:c.contentHtml,this.config.additionalClasses="additionalClasses"in t?t.additionalClasses:c.additionalClasses,this.config.dontShowOnClick="dontShowOnClick"in t?t.dontShowOnClick:c.dontShowOnClick,this.config.showOnMouseOver="showOnMouseOver"in t?t.showOnMouseOver:c.showOnMouseOver):this.config=c}positionTip(t,e,i){const n=this.$tooltip.find(".tooltip-tip");n.removeClass("tip-left tip-right tip-up tip-down"),t===r.left?n.addClass("tip-right"):t===r.right?n.addClass("tip-left"):e===l.below?n.addClass("tip-up"):e===l.above?n.addClass("tip-down"):n.addClass("tip-up"),n.css("left",""),n.css("top",""),n.css("right",""),n.css("bottom",""),i&&(i.left&&n.css("left",i.left),i.top&&n.css("top",i.top),i.right&&n.css("right",i.right),i.bottom&&n.css("bottom",i.bottom))}centerMenuHorizontaly(t,e){switch(e){case r.left:this.centerMenuHorizontalyLeft(t);break;case r.right:this.centerMenuHorizontalyRight(t);break;default:this.centerMenuHorizontalyCenter(t)}}centerMenuVertically(t,e){switch(e){case l.above:this.centerMenuVerticallyAbove(t);break;case l.center:this.centerMenuVerticallyCenter(t);break;default:this.centerMenuVerticallyBelow(t)}}centerMenuHorizontalyLeft(t){this.$tooltip.css("left",this.keepLeftPositionOnScreen(this.getOffsetFromParentContainer(t).left-this.getElementWidth(t)-this.$tooltip.width())+"px")}centerMenuHorizontalyCenter(t){this.$tooltip.css("left",this.keepLeftPositionOnScreen(this.getOffsetFromParentContainer(t).left-this.$tooltip.width()/2+this.getElementWidth(t)/4)+"px")}centerMenuHorizontalyRight(t){this.$tooltip.css("left",this.keepLeftPositionOnScreen(this.getOffsetFromParentContainer(t).left+this.getElementWidth(t))+"px")}keepLeftPositionOnScreen(t){if(t<=10)return 10;const e=this.$tooltip.width(),i=$(window).width();if(t+e+10>=i){return t-Math.abs(i-t-e-10)}return t}centerMenuVerticallyAbove(t){this.$tooltip.css("top",this.getOffsetFromParentContainer(t).top-this.getElementHeight(t)-this.$tooltip.height()+"px")}centerMenuVerticallyCenter(t){this.$tooltip.css("top",this.getOffsetFromParentContainer(t).top-this.$tooltip.height()/2+"px")}centerMenuVerticallyBelow(t){this.$tooltip.css("top",this.getOffsetFromParentContainer(t).top+this.getElementHeight(t)+"px")}close(){this.$tooltip.css({display:"none",top:"initial",left:"initial",bottom:"initial",right:"initial"}),this.isOpen=!1,s.off("click",this.handleDocumentClick),a.off("resizestart",this.handleResizeStart),this.currentReferentElement=null,this.afterCloseCallback&&this.afterCloseCallback(),this.$tooltip.removeClass("advanced-tooltip-opened")}handleReferentElementInteraction(t){this.open(t)}handleCommandRowClick(t){this.currentReferentElement&&this.commandExecuteCallback&&this.commandExecuteCallback($(this.currentReferentElement),$(t))}handleDocumentClick(t){const e=t.target;this.$tooltip.is(e)||0!==this.$tooltip.has(e).length||this.currentReferentElement===e||0!==$(this.currentReferentElement).has(e).length||this.close()}handleResizeStart(){this.close()}getOffsetFromParentContainer(t){if(this.config.isFixed)return t[0].getBoundingClientRect();const e=this.$parentContainer.offset()||{top:0,left:0},i=t.offset()||{top:0,left:0};return{top:i.top-e.top,left:i.left-e.left}}getElementWidth(t){if(!t||!t.length)return 0;const e=t[0];if(e.getBBox){const t=e.getBBox();if(t)return t.width}let i=t.width();if(i)return i;if(e.getBoundingClientRect){const t=e.getBoundingClientRect();if(t)return t.width}return 0}getElementHeight(t){const e=t[0];if(e.getBBox){const t=e.getBBox();if(t)return t.height}let i=t.height();if(i)return i;if(e.getBoundingClientRect){const t=e.getBoundingClientRect();if(t)return t.height}return 0}}const d='<div class="advanced-tooltip"><div class="tooltip-container"></div><div class="tooltip-tip"></div></div>'},196:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i(14),o=i(1),s=i(6);const a=$(document);const r=new class{constructor(){$(document).on("appActivatedAfterLongTime",()=>{this.wishList=null,this.wishListPromise=null,this.isSyncing=!1})}hasInitializedWishList(){return null!=this.wishList}onSyncingChanged(t){this.syncingCallback=t}isBookInWishList(t){return null!=t&&this.isProductInWishList(t.manningId)}isProductInWishList(t){return null!=this.wishList&&null!=this.wishList.items&&0!=this.wishList.items.length&&null!=this.wishList.items.find(e=>null!=e.product&&e.product.id==t)}updateSyncing(t){this.isSyncing!=t&&(this.isSyncing=t,this.syncingCallback&&this.syncingCallback())}addBookToWishList(t){return this.addProductToWishList(t.manningId)}addProductToWishList(t){return new Promise((e,i)=>{this.getUserWishList().then(s=>{if(!s.id)return i("User is not logged in");this.updateSyncing(!0),o.a.postToOurBackend(o.a.getAbsoluteUrl(`api/wishList/${s.id}/addItem/${t}`),n=>{this.updateSyncing(!1),this.syncingCallback&&this.syncingCallback(),n?(this.wishList=n,e(n),this.wishListPromise=Promise.resolve(this.wishList),a.trigger("wishListArrived",n),a.trigger("wishListAdd",[t,!0])):i("Not enough information")},t=>{this.updateSyncing(!1),i(),n.a.getUserEmail().then(t=>{a.trigger("wishListFail",[`${t}-${(new Date).getTime()}`,"N/A","N/A"])}).catch(t=>{a.trigger("wishListFail",[`unknownUser-${(new Date).getTime()}`,"N/A","N/A"])})},{},!0,!0,!1,!1)}).catch(t=>i(t))})}removeProductFromWishList(t){return new Promise((e,i)=>{this.getUserWishList().then(s=>{const r=s.items.find(e=>e.product.id==t);if(!r)return i("wish list item not found");this.updateSyncing(!0),o.a.interactWithOurBackend(o.a.getAbsoluteUrl(`api/wishList/removeItem/${r.id}`),"delete",n=>{if(this.updateSyncing(!1),!n)return a.trigger("wishListFail",[`unknownUser-${(new Date).getTime()}`,"N/A","N/A"]),void i("Not enough information");this.wishList=n,e(n),this.wishListPromise=Promise.resolve(this.wishList),a.trigger("wishListArrived",n),a.trigger("wishListRemove",[t])},t=>{this.updateSyncing(!1),n.a.getUserEmail().then(t=>{a.trigger("wishListFail",[`${t}-${(new Date).getTime()}`,"N/A","N/A"])}).catch(t=>{a.trigger("wishListFail",[`unknownUser-${(new Date).getTime()}`,"N/A","N/A"])})},{},!0,!0,!1,!1)}).catch(t=>i(t))})}getUserWishList(){return s.a.isCurrentlyLoggedIn()?null!=this.wishListPromise?this.wishListPromise:this.wishListPromise=new Promise((t,e)=>{this.updateSyncing(!0),o.a.getFromOurBackend(o.a.getAbsoluteUrl("wishList"),i=>{if(this.updateSyncing(!1),!i)return a.trigger("wishListFail",[`unknownUser-${(new Date).getTime()}`,"N/A","N/A"]),void e("Not enough information");this.wishList=i,t(i),this.wishListPromise=Promise.resolve(this.wishList),a.trigger("wishListArrived",i)},t=>{this.wishListPromise=null,this.updateSyncing(!1),n.a.getUserEmail().then(t=>{a.trigger("wishListFail",[`${t}-${(new Date).getTime()}`,"N/A","N/A"])}).catch(t=>{a.trigger("wishListFail",[`unknownUser-${(new Date).getTime()}`,"N/A","N/A"])})},{},!0,!0,!1,!1)}):Promise.resolve({id:-1,title:"",items:[]})}}},232:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n=i(4);class o{constructor(t,e,i){this.currentIndex=0,this.$mainContainer=t,this.beforeTabSwitchCallback=i,this.afterTabSwitchCallback=e,n.a.onDescendantEventWithCooldown(this.$mainContainer,"click touchstart",".tab-title",t=>{const e=this.$mainContainer.find(".tab-title").index(t.currentTarget);this.beforeTabSwitchCallback&&this.beforeTabSwitchCallback(e),this.selectTab(e),this.afterTabSwitchCallback&&this.afterTabSwitchCallback(e)}),this.selectTab(this.currentIndex)}selectTab(t){const e=this.$mainContainer.find(".tab-title"),i=this.$mainContainer.find(".tab-container");e.removeClass("selected"),i.removeClass("selected"),e.eq(t).length?e.eq(t).addClass("selected"):e.eq(0).addClass("selected"),i.eq(t).length?(i.eq(t).addClass("selected"),this.currentIndex=t):(i.eq(0).addClass("selected"),this.currentIndex=0)}getCurrentlySelectedTabIndex(){return this.currentIndex}}},259:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n=i(2);const o=new class{constructor(){this.shouldWishListABeShown=!0}initialize(t){this.getWishListManagerSource().then(({WishListManager:e})=>e.initalize(t))}clean(){this.getWishListManagerSource().then(({WishListManager:t})=>t.clean())}addCurrentBookToWishList(){this.getWishListManagerSource().then(({WishListManager:t})=>t.addCurrentBookToWishList())}getWishListManagerSource(){return this.wishListManagerSourcePromise||(this.wishListManagerSourcePromise=n.a.importWebpackModuleWithRetry(this.constructWishListManagerSourcePromise)),this.wishListManagerSourcePromise}constructWishListManagerSourcePromise(){return i.e(114).then(i.bind(null,533))}}},262:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(16),o=i(138);class s{constructor(t,e,i,s=""){this.$sortIcon=t,this.books=e,this.callback=i,this.advancedTooltip=new o.c,t.removeClass("hidden"),this.advancedTooltip.initialize(t,()=>{},(t,e)=>{const i=e.closest(".advanced-tooltip");i.removeClass("alphabetical-sort release-date-sort last-opened-sort"),e.is(".alphabetical-sort")?(n.a.sortBooksAlphabetically(this.books),i.addClass("alphabetical-sort")):e.is(".release-date-sort")?(n.a.sortBooksByLastUpdateDate(this.books),i.addClass("release-date-sort")):e.is(".last-opened-sort")&&(n.a.sortBooksByLastAccess(this.books),i.addClass("last-opened-sort")),this.callback&&this.callback(),this.advancedTooltip.close()},()=>{},{horizontalPosition:o.a.center,verticalPosition:o.b.below,dontAutomaticallyPosition:!0,additionalClasses:"sort-books-tooltip "+s,contentHtml:a,isFixed:!1}),this.$tooltip=this.advancedTooltip.$tooltip}clean(){this.$sortIcon=null,this.callback=null,this.books=null,this.advancedTooltip.clean()}updateSortIcon(t){this.$sortIcon=t,this.advancedTooltip.updateReferentElement(this.$sortIcon)}}const a='\n<div class="sort-books-tooltip-item item-row alphabetical-sort">alphabetical <span class="fa fa-check"></span></div>\n<div class="sort-books-tooltip-item item-row release-date-sort">release date <span class="fa fa-check"></span></div>\n<div class="sort-books-tooltip-item item-row last-opened-sort">last opened <span class="fa fa-check"></span></div>'},264:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));const n=new class{render(t,e){null!=t&&null!=e&&null!=e.partialChapterOwnership&&0!=e.partialChapterOwnership.length&&(t.innerHTML=e.partialChapterOwnership.map(t=>{let e=t.userOwned||t.partiallyOwned?t.shortName:"";return e&&(e="you own "+(e=e.replace("-"," "))+" in this book"),`<span data-partial-ownership-id="${t.shortName}" \n                            class="ownership-line chapter-ownership-line ${t.fullyOwned?"is-fully-owned":""}" \n                            title="${e}">\n                            ${t.partiallyOwned?'<span class="is-partially-owned"></span>':""}\n                    </span>`}).join(""))}}},77:function(t,e,i){"use strict";i.r(e),i.d(e,"BooksMenu",(function(){return k}));var n=i(41),o=i(232),s=i(262),a=i(25),r=i(1),l=i(264),c=i(14),h=i(196),d=i(4),u=i(259),m=i(19),p=i(6),f=(i(801),i(2));const g='<div id="books-menu" class="slide-in-menu slide-in-menu-left closed"><div class="slide-in-menu-container"><div class="loading-container"><i class="fal fa-spin fa-circle-notch fa-3x fa-fw"></i></div></div></div>',b='\n    <div class="tab-title-container">\n        {{#userOwnsBooks}}\n            <div class="tab-title"><span class="books-menu-user-name">your</span> books</div>\n        {{/userOwnsBooks}}\n        <div class="tab-title">library</div>\n        {{#hasRelatedProducts}}<div class="tab-title">related</div>{{/hasRelatedProducts}}\n        {{#hasWishListMenu}}\n        <div class="tab-title">wish list <i class="fa fa-heart heart-icon-tab-title" aria-hidden="true"></i></div>\n        {{/hasWishListMenu}}\n    </div>\n    <div class="tabs-container">\n    {{#userOwnsBooks}}\n    <div class="tab-container">\n        <div class="search-input-container">\n            <input type="text" class="search-input" placeholder="find in my books">\n            <div class="books-menu-sort-container">\n                sort <i class="fa fa-sort sort-my-books-menu-icon" aria-hidden="true"></i>\n            </div>\n        </div>\n        <div class="items-container">\n            {{#userOwnedBooks}}\n            <div class="book-item book-item-row {{#partialBookOwnership}}partially-owned-book-row{{/partialBookOwnership}}" data-book-short-name="{{shortName}}">\n                <div class="book-cover-column">\n                    <a href="{{bookPath}}" class="book-cover-link">\n                        <img class="book-cover" src="{{bookCoverPath}}" alt="book cover">\n                        {{#hasAudio}}\n                        <div class="liveaudio-corner">\n                            <svg viewBox="0 0 1792 1792">\n                                <use xlink:href="#liveaudio-corner">\n                            </svg>\n                        </div>\n                        {{/hasAudio}}\n                    </a>\n                    {{#partialBookOwnership}}\n                    <div class="partial-book-ownership-line" cellspacing="0">\n                        <span class="partial-book-ownership-loading-line"></span>\n                    </div>\n                    {{/partialBookOwnership}}\n                </div>\n                <div class="book-info-column">\n                    <a href="{{bookPath}}">\n                        <div class="book-title">{{cleanTitle}}</div>\n                        <div class="book-authors">{{{authors}}}</div>\n                    </a>\n                </div>\n            </div>\n            {{/userOwnedBooks}}\n        </div>\n    </div>\n{{/userOwnsBooks}}\n<div class="tab-container">\n    <div class="search-input-container">\n        <input type="text" class="search-input" placeholder="find in the whole library">\n        <div class="books-menu-sort-container">\n            sort <i class="fa fa-sort sort-library-menu-icon" aria-hidden="true"></i>\n        </div>\n    </div>\n    <div class="items-container">\n        <ul>\n            {{#library}}\n            <li class="row short book-item-row book-item" data-book-short-name="{{shortName}}">\n                <div class="columns small-10"> \n                    <a href="{{bookPath}}">\n                        <span class="book-title">{{cleanTitle}}</span>\n                    </a>\n                </div>\n                <div class="columns small-1">\n                {{#userOwnsBook}}\n                    <i class="fa fa-check" style="color: green" title="you own this book"></i>\n                {{/userOwnsBook}}\n                </div>\n            </li>\n            {{/library}}\n        </ul>\n    </div>\n</div>\n{{#hasRelatedProducts}}\n<div class="tab-container">\n    <div class="search-input-container">\n        <input type="text" class="search-input" placeholder="find in related products">\n        <div class="books-menu-sort-container">\n            sort <i class="fa fa-sort sort-library-menu-icon" aria-hidden="true"></i>\n        </div>\n    </div>\n    <div class="items-container related-books-menu-container">\n        {{#relatedProducts}}                  \n        <div class="book-item book-item-row" data-book-short-name="{{externalId}}">\n            <div class="book-cover-column">\n                <a href="{{link}}" class="book-cover-link related-books-link" data-product-id="{{id}}">\n                    <img class="book-cover" src="{{imageUrl}}" alt="book cover">\n                    {{#hasAudio}}\n                    <div class="liveaudio-corner">\n                        <svg viewBox="0 0 1792 1792">\n                            <use xlink:href="#liveaudio-corner">\n                        </svg>\n                    </div>\n                    {{/hasAudio}}\n                </a>\n            </div>\n            <div class="book-info-column">\n                <a href="{{link}}" class="related-books-link" data-product-id="{{id}}">\n                    <div class="book-title">{{title}}</div>\n                    <div class="book-authors">{{authors}}</div>\n                </a>\n            </div>\n        </div>\n        {{/relatedProducts}}\n    </div>\n</div>\n{{/hasRelatedProducts}}\n{{#hasWishListMenu}}\n<div class="tab-container">\n    <div class="search-input-container">\n        <input type="text" class="search-input" placeholder="find in my wish list">\n        <div class="books-menu-sort-container">\n            sort <i class="fa fa-sort sort-library-menu-icon" aria-hidden="true"></i>\n        </div>\n    </div>\n    <div class="items-container wish-list-container">\n        {{#wishList}}\n            <div class="book-item book-item-row" data-book-short-name="{{shortName}}">\n                <div class="book-cover-column">\n                    <a href="{{bookPath}}" class="book-cover-link">\n                        <img class="book-cover" src="{{bookCoverPath}}" alt="book cover">\n                        {{#hasAudio}}\n                        <div class="liveaudio-corner">\n                            <svg viewBox="0 0 1792 1792">\n                                <use xlink:href="#liveaudio-corner">\n                            </svg>\n                        </div>\n                        {{/hasAudio}}\n                    </a>\n                    {{#partialBookOwnership}}\n                    <div class="partial-book-ownership-line" cellspacing="0">\n                        <span class="partial-book-ownership-loading-line"></span>\n                    </div>\n                    {{/partialBookOwnership}}\n                </div>\n                <div class="book-info-column">\n                    <a href="{{bookPath}}">\n                        <div class="book-title">{{cleanTitle}}</div>\n                        <div class="book-authors">{{authors}}</div>\n                    </a>\n                    <div class="wishlist-command-container">\n                        <span class="emphasized-button add-to-cart-button" data-manning-id="{{manningId}}" title="add to cart">\n                            <i class="fa fa-cart-plus"></i> add to cart\n                        </span>\n                        <span class="remove-from-wishlist-button" data-manning-id="{{manningId}}" title="remove from wishlist">\n                            <i class="fa fa-trash" data-manning-id="{{manningId}}"></i>\n                        </span>\n                    </div>\n                </div>\n            </div>\n        {{/wishList}}\n        {{#isNotLoggedIn}}\n            <div class="slide-menu-message-container"><span class="sign-in-button wish-list-sign-in-button">sign in</span> to add books to your wishlist</div>\n        {{/isNotLoggedIn}}\n        {{#loggedInButNoWishlistItems}}\n            <div class="slide-menu-message-container">go to a book you don\'t own and add it to your wishlist</div>\n        {{/loggedInButNoWishlistItems}}\n        <div class="syncing-wish-list-frame">\n            <i class="fal fa-spin fa-circle-notch fa-3x fa-fw"></i>\n        </div>\n    </div>\n</div>\n{{/hasWishListMenu}}\n</div>',k=new class{constructor(){$(document.body).append(g),this.handleSearchInputChange=this.handleSearchInputChange.bind(this),this.$booksButton=$(".books-button"),this.$booksMenu=$("#books-menu"),this.slideMenu=new n.a(this.$booksButton,this.$booksMenu,()=>this.buildBookMenuContent(),()=>{},!0,()=>this.emptyMenu()),$(document).on("requestBooksMenuOpen",()=>this.open()),$(document).on("click",".settings-menu-books-item",()=>{setTimeout(()=>{this.open()},150)})}buildBookMenuContent(){$(document).trigger("searchHideRequested"),p.a.isLoggedIn().then(t=>{const e=m.a.getUsersLibraryAndCatalog(!!t.loggedIn),i=this.currentBookElement&&this.currentBookElement.book?m.a.getRelatedProducts(this.currentBookElement.book.shortName):Promise.resolve([]);Promise.all([e,i,h.a.getUserWishList(),f.a.loadMustacheCode()]).then(t=>{const e=t[0],i=t[1],n=t[2];this.expandRelatedProducts(i,e.catalog),this.initializeMenuWithBooks(e.userLibrary,e.catalog,i,this.buildWishListBooks(n,e.catalog))}).catch(t=>{console.log("Couldn't fetch books",t)})})}expandRelatedProducts(t,e){const i={};for(const t of e)i[t.shortName]=t;for(const e of t){const t=i[e.externalId];null!=t&&(e.hasAudio=t.hasAudio)}t.length&&$(document).trigger("impressions",[t.map(t=>{let e="development";return i[t.externalId]&&i[t.externalId].categories?e=i[t.externalId].categories:console.log("Missing category for:",t.externalId),{id:t.id,title:t.title,category:e}}),"related books"])}initialize(t,e){if(this.currentBookElement=e,null!=t){if(this.catalogBooks&&this.catalogBooks.length)for(const i of this.catalogBooks)i.shortName===t.shortName&&this.updateBookProgress(i,e);if(this.userBooks&&this.userBooks.length)for(const i of this.userBooks)i.shortName===t.shortName&&this.updateBookProgress(i,e)}}clean(){this.sortMyBooksTooltip&&(this.sortMyBooksTooltip.clean(),this.sortMyBooksTooltip=null),this.sortLibraryTooltip&&(this.sortLibraryTooltip.clean(),this.sortLibraryTooltip=null),this.catalogBooks=null,this.userBooks=null,this.currentBookElement=null,this.tabs=null}open(){this.slideMenu&&this.slideMenu.openMenu()}updateBookProgress(t,e){t.progressBookElement=e?e.shortName:"chapter-1",t.lastBookElementItem="1",t.bookPath=r.a.getBookElementUrl(t.shortName,t.progressBookElement,e.meapVersion)+t.lastBookElementItem,t.lastAccessedTime=Date.now()}buildWishListBooks(t,e){return t.items.map(t=>e.find(e=>e.manningId===t.product.id)).filter(t=>!!t)}initializeMenuWithBooks(t,e,i,n){if(!e||!e.length)return;this.catalogBooks=e,this.userBooks=t,e.filter(e=>{const i=t.find(t=>t.shortName===e.shortName);e.userOwnsBook=!!i});const a=$(Mustache.render(b,{userOwnsBooks:t&&t.length>0&&t.length!==e.length,userOwnedBooks:t,wishList:n,hasWishListMenu:u.a.shouldWishListABeShown,loggedInButNoWishlistItems:p.a.isCurrentlyLoggedIn()&&null!=n&&0==n.length,isNotLoggedIn:!p.a.isCurrentlyLoggedIn(),library:e,relatedProducts:i,hasRelatedProducts:i&&i.length}));if(d.a.onEventWithCooldown(a.find(".add-to-cart-button"),"click",t=>this.addToCart(t,e)),d.a.onEventWithCooldown(a.find(".remove-from-wishlist-button"),"click",n=>this.removeFromWishList(n,t,e,i)),a.find(".partial-book-ownership-line").each((t,e)=>{const i=$(e).closest("[data-book-short-name]").attr("data-book-short-name");m.a.getChapterOwnership(i).then(t=>{null!=t&&l.a.render(e,t)}).catch(t=>{console.log("Error loading partial book ownership")})}),this.$booksMenu.find(".slide-in-menu-container").empty().append(a),null==this.tabs)this.tabs=new o.a(this.$booksMenu);else{const t=this.tabs.getCurrentlySelectedTabIndex();this.tabs=new o.a(this.$booksMenu),this.tabs.selectTab(t)}a.find(".search-input").on("input",this.handleSearchInputChange),p.a.isLoggedIn().then(t=>{t.loggedIn&&c.a.getUserFirstName().then(t=>{this.$booksMenu.find(".books-menu-user-name").text(t+"'s")})}),this.sortMyBooksTooltip?this.sortMyBooksTooltip.updateSortIcon($(".sort-my-books-menu-icon")):this.sortMyBooksTooltip=new s.a($(".sort-my-books-menu-icon"),t,()=>this.initializeMenuWithBooks(t,e,i,n),"book-menu-sort-tooltip"),this.sortLibraryTooltip?this.sortLibraryTooltip.updateSortIcon($(".sort-library-menu-icon")):this.sortLibraryTooltip=new s.a($(".sort-library-menu-icon"),e,()=>this.initializeMenuWithBooks(t,e,i,n),"book-menu-sort-tooltip"),this.slideMenu.setAssociatedElement(this.sortLibraryTooltip.$tooltip.add(this.sortMyBooksTooltip.$tooltip)),this.handleCoverLoading()}handleSearchInputChange(t){clearTimeout(this.timerId);const e=$(t.target).val();this.timerId=setTimeout(()=>this.filterBooks(t.target,e),200)}addToCart(t,e){const i=e.find(e=>e.manningId===$(t.target).data("manning-id"));a.a.requestAddBookToCart(i,!1,null,!0),$(document).trigger("wishListAddToCart",[i.shortName])}removeFromWishList(t,e,i,n){const o=$(t.target).data("manning-id"),s=h.a.wishList.items.find(t=>t.product.id==o);if(s){const t=this.$booksMenu.find(".syncing-wish-list-frame");t.css("display","flex"),h.a.removeProductFromWishList(s.product.id).then(o=>{t.css("display","none");const a=this.buildWishListBooks(o,i);this.initializeMenuWithBooks(e,i,n,a),$(document).trigger("wishListRemove",[s.product.id])}).catch(e=>{$(document).trigger("requestNotification","error syncing wishlist"),t.css("display","none")})}}filterBooks(t,e){const i=$(t).parents(".tab-container").find(".items-container");(e=e.trim().toLowerCase())?i.find(".book-item").each((t,i)=>{const n=$(i);n.toggleClass("hidden",-1===n.text().toLowerCase().indexOf(e))}):i.find(".hidden").removeClass("hidden")}handleCoverLoading(){const t=this.$booksMenu.find(".book-cover");t.on("load",t=>$(t.target).closest(".book-item").removeClass("hidden")),t.on("error",t=>$(t.target).closest(".book-item").remove())}emptyMenu(){this.$booksMenu.find(".slide-in-menu-container").empty().html('<div class="loading-container">\n                <i class="fal fa-spin fa-circle-notch fa-3x fa-fw"></i>\n            </div>')}};$(document).on("relatedBooksClick",(t,e,i)=>{if(!i||Number.isNaN(i))return;const n=$(e);m.a.getMediumCatalog().then(t=>{const e=t.find(t=>t.manningId==i);null!=e&&$(document).trigger("impressionClick",[{id:e.manningId,title:e.title,category:e.categories,position:n.closest(".book-item-row").index()},"related books"])})})},801:function(t,e,i){var n=i(88),o=i(802);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var s={insert:"head",singleton:!1};n(o,s);t.exports=o.locals||{}},802:function(t,e,i){(e=i(89)(!1)).push([t.i,"#books-menu{left:0;width:440px}#books-menu .slide-in-menu-container{overflow:hidden;background-color:#e8e8e8;color:#443;border-right:1px solid #d0cdcd}#books-menu .books-menu-sort-container{color:inherit}#books-menu .search-input-container{display:flex;align-items:center;justify-content:space-between;margin:1em}#books-menu .search-input-container input{width:100%;margin:0}#books-menu .search-input-container .books-menu-sort-container{white-space:nowrap;margin-left:1.1em;padding-right:0;font-size:90%}#books-menu .partially-owned-book-row .liveaudio-corner{bottom:0.3em}#books-menu .book-item-row{padding:0 1em 1em 1em;display:flex}#books-menu .book-item-row .book-cover-column{width:25%;margin-right:1em;position:relative}#books-menu .book-item-row .book-info-column{width:75%}@media screen and (max-width: 380px){#books-menu .book-item-row .book-cover-column{width:33%}#books-menu .book-item-row .book-info-column{width:66%}}#books-menu .book-item-row .emphasized-button{margin:0}#books-menu .book-item-row .book-title{color:#443;font-size:1rem;font-weight:300;line-height:1.1;margin-top:0.5em}#books-menu .book-item-row .book-authors{font-size:0.75rem;font-weight:300;color:#5c5c5c;line-height:1.1;margin-top:5px}#books-menu .book-item-row .partial-book-ownership-line{margin-top:0.1em}#books-menu .heart-icon-tab-title{color:#F65B61}#books-menu .sign-in-button{text-decoration:underline;cursor:pointer}#books-menu .slide-menu-message-container{font-style:italic;user-select:none;color:#777777;font-weight:300;margin:0 1em}#books-menu .wish-list-container{position:relative}#books-menu .syncing-wish-list-frame{position:absolute;top:0;left:0;right:0;bottom:1em;background-color:rgba(0,0,0,0.2);color:white;display:none;align-items:center;justify-content:center}\n",""]),t.exports=e},88:function(t,e,i){"use strict";var n,o=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},s=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),a=[];function r(t){for(var e=-1,i=0;i<a.length;i++)if(a[i].identifier===t){e=i;break}return e}function l(t,e){for(var i={},n=[],o=0;o<t.length;o++){var s=t[o],l=e.base?s[0]+e.base:s[0],c=i[l]||0,h="".concat(l," ").concat(c);i[l]=c+1;var d=r(h),u={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(a[d].references++,a[d].updater(u)):a.push({identifier:h,updater:g(u,e),references:1}),n.push(h)}return n}function c(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var o=i.nc;o&&(n.nonce=o)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var a=s(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var h,d=(h=[],function(t,e){return h[t]=e,h.filter(Boolean).join("\n")});function u(t,e,i,n){var o=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=d(e,o);else{var s=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(s,a[e]):t.appendChild(s)}}function m(t,e,i){var n=i.css,o=i.media,s=i.sourceMap;if(o?t.setAttribute("media",o):t.removeAttribute("media"),s&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var p=null,f=0;function g(t,e){var i,n,o;if(e.singleton){var s=f++;i=p||(p=c(e)),n=u.bind(null,i,s,!1),o=u.bind(null,i,s,!0)}else i=c(e),n=m.bind(null,i,e),o=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=o());var i=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<i.length;n++){var o=r(i[n]);a[o].references--}for(var s=l(t,e),c=0;c<i.length;c++){var h=r(i[c]);0===a[h].references&&(a[h].updater(),a.splice(h,1))}i=s}}}},89:function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var o=(a=n,r=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),"/*# ".concat(l," */")),s=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[i].concat(s).concat([o]).join("\n")}var a,r,l;return[i].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,n){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(n)for(var s=0;s<this.length;s++){var a=this[s][0];null!=a&&(o[a]=!0)}for(var r=0;r<t.length;r++){var l=[].concat(t[r]);n&&o[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),e.push(l))}},e}}}]);
//# sourceMappingURL=booksModule.chunk.js.map?dd6564b9fc1e5564a4cf